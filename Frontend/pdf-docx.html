<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>FormatForge | PDF to DOCX</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="index.css">
</head>

<body class="theme-glass d-flex flex-column">

  <!-- Background -->
  <div class="bg-image"></div>
  <div class="bg-blur"></div>

  <!-- NAVBAR -->
  <div id="navbar-container"></div>

  <!-- ================= PDF → DOCX UI ================= -->
  <main class="flex-grow-1 d-flex align-items-center justify-content-center"
        style="padding-top:80px; padding-bottom:80px;">
    <section class="w-100">
      <div class="container">

        <h2 class="text-center text-white mb-4">
          Convert PDF to DOCX
        </h2>

        <div class="row justify-content-center">
          <div class="col-md-6">

            <div class="glass-overlay">

              <!-- PDF Upload -->
              <input
                type="file"
                class="form-control mb-3"
                id="pdfInput"
                accept="application/pdf"
                required
              >

              <!-- Convert Button -->
              <button
                id="convertBtn"
                class="btn btn-primary w-100"
              >
                Convert to DOCX
              </button>

              <!-- Status -->
              <div id="status" class="mt-3 text-center"></div>

              <!-- Download -->
              <a
                id="downloadBtn"
                class="btn btn-success w-100 mt-3 d-none"
              >
                Download DOCX
              </a>

            </div>

          </div>
        </div>

      </div>
    </section>
  </main>
  <!-- ================================================ -->

  <!-- FOOTER -->
  <footer class="bg-dark text-white text-center py-3 fixed-bottom">
    © 2025 FORMATFORGE | Final Year Project
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- ================= SCRIPT ================= -->
  <script>
    /* Load Navbar */
    fetch("navbar.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("navbar-container").innerHTML = html;
      });

    const convertBtn = document.getElementById("convertBtn");
    const pdfInput = document.getElementById("pdfInput");
    const status = document.getElementById("status");
    const downloadBtn = document.getElementById("downloadBtn");

    convertBtn.addEventListener("click", async () => {
      const file = pdfInput.files[0];

      if (!file) {
        status.innerHTML = "<span class='text-danger'>Please select a PDF file</span>";
        return;
      }

      status.innerHTML = "Uploading PDF...";

      const formData = new FormData();
      formData.append("file", file);

      try {
        const response = await fetch(
          "http://127.0.0.1:8000/convert-pdf-to-docx",
          {
            method: "POST",
            body: formData
          }
        );

        if (!response.ok) {
          throw new Error("Conversion failed");
        }

        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);

        downloadBtn.href = url;
        downloadBtn.download = "formatforge.docx";
        downloadBtn.classList.remove("d-none");

        status.innerHTML =
          "<span class='text-success'>DOCX ready for download</span>";

      } catch (err) {
        status.innerHTML =
          "<span class='text-danger'>Backend error during conversion</span>";
      }
    });
  </script>

</body>
</html>
